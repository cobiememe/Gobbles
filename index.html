<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" type="image/png" href="/img/favicon.png">
  
<!-- Barlow Font -->
<link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;600;700;800&display=swap" rel="stylesheet">
  
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Chart Data Labels Plugin -->
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<!-- Solana Web3 -->
<script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<title>Gobbles ‚Äî Cope Harder!</title>

<!-- CSS -->
<link rel="stylesheet" href="/style.css">
</head>
<body>
<!-- ‚≠ê Partikel/Sterne Canvas -->
<canvas id="particles"></canvas>

<header>
  <div class="h-wrap">
    <div class="brand-wrap">
      <img id="logoImg" src="/img/1boss.png" class="logo-anim" alt="Gobbles">
      <div>
        <div class="brand-main"><span class="g-wobble">G</span>obbles</div>
        <div class="small">Cope Harder!</div>
      </div>

      <!-- üîπ Cobie Home Button -->
      <a href="https://www.cobie.uk/" target="_blank" class="home-link">
        <img src="/img/cobieGif.gif" alt="Cobie" class="cobie-gif">
        <span class="home-text">Cobie Main</span>
      </a>
    </div>

    <div class="header-right-wrap">
      <span class="profile-link">Profile</span>
      <span id="wallet-status" class="status">Not connected</span>
      <button id="connectBtn" class="btn connect-btn">Connect Wallet</button>
    </div>
  </div>
  <!-- üîπ Neon-Lichtstreifen unter dem Header -->
  <div class="header-glow"></div>
</header>

<!-- Sound for posts -->
<audio id="postSound">
  <source src="/sounds/mgs2.mp3" type="audio/mpeg">
</audio>

<!-- Boom Sound for new posts -->
<audio id="boomSound">
  <source src="/sounds/coin.mp3" type="audio/mpeg">
</audio>

<!-- Rick Easter Egg Sound -->
<audio id="rickSound">
  <source src="/sounds/portal.mp3" type="audio/mpeg">
</audio>

<!-- === Profile Modal === -->
<div id="profileModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeProfile()">&times;</span>
    <div class="profile-body">
      <!-- Left Side -->
      <div class="profile-left">
        <h2>Your Profile</h2>

        <!-- üß¨ Level-Anzeige im Profil -->
        <div id="profileLevelBadge" class="profile-level-badge"></div>

        <label class="input-label">Profile Image</label>
        <img id="avatarPreview" class="avatar-preview" alt="Avatar Preview">

        <div class="profile-image-buttons">
          <label for="avatarUpload" class="upload-btn">Upload Image</label>
          <button class="reset-btn" onclick="resetAvatar()">üîÅ Reset to NFT</button>
        </div>
        <input type="file" id="avatarUpload" accept="image/*" class="file-hidden">

        <label class="input-label">About you (max 140 chars)</label>
        <textarea id="bioInput" maxlength="140" class="text-input" placeholder="Write something about yourself (max 140 chars)..."></textarea>

        <h3 style="margin-top:20px;">Portfolio Allocation</h3>
        
        <div class="input-pair">
          <input type="text" class="text-input asset-input" placeholder="Asset (e.g. Solana)" id="assetInput">
          <input type="number" class="text-input percent-input" placeholder="%" id="percentInput">
        </div>
        
        <div class="portfolio-list" id="portfolioList"></div>
        
        <div class="small" style="color: var(--muted); margin-top: 8px;">
          Press Enter after filling both fields to add assets
        </div>

        <button class="btn" onclick="saveProfile()" style="margin-top: 15px;">üíæ Save Profile</button>
      </div>

      <!-- Right Side -->
      <div class="profile-right">
        <canvas id="portfolioChart"></canvas>

        <!-- üîπ Bio-Anzeige unter dem Chart -->
        <div id="bioDisplay" 
             style="margin-top:20px;
                    white-space:pre-line;
                    color:#9ed9e6;
                    font-size:14px;
                    line-height:1.4;
                    text-align:center;">
        </div>
      </div>
    </div>
  </div>
</div>

<!-- === HENSHIN Reply Modal === -->
<div id="replyModal" class="reply-modal hidden">
  <div class="reply-box">
    <h3>üåÄ HENSHIN ‚Äì Reply</h3>
    <textarea id="replyText" maxlength="140" placeholder="Type your reply (max 140 chars)..."></textarea>
    <div class="reply-actions">
      <span id="charCount">0 / 140</span>
      <button id="cancelReply">Cancel</button>
      <button id="sendReply">Send</button>
    </div>
  </div>
</div>

<!-- === Reply Side Panel === -->
<div id="replyPanel" class="reply-panel hidden">
  <div class="reply-panel-inner">
    <div class="reply-header">
      <h3><span class="icon">üåÄ</span> Replies</h3>
      <button id="closeReplies" class="close-replies">‚úñ</button>
    </div>
    <div id="replyList" class="reply-list"></div>
  </div>
</div>

<main class="container">
  <div class="grid">
    <section>
      <div class="card">
        <div class="body">
          <h3>Create Post</h3>
          <textarea id="postText" maxlength="140" placeholder="What's happening? Use #hashtags for trends!"></textarea>
          <div style="display:flex;gap:12px;align-items:center;margin-top:8px">
            <div class="small">Fee: 0.001 SOL</div>
            <div style="flex:1"></div>
            <button id="postBtn" class="btn">Post</button>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <div class="body">
          <h3>Community Feed <span id="filterBadge" style="display:none"></span></h3>
        </div>
        <div class="feed-separator"></div>

        <div id="feed"></div>
      </div>
    </section>

    <aside>
      <div class="card">
        <div class="body">
          <h3>Trending</h3>
          <div id="trendBox">
            <div class="small" style="text-align:center;padding:20px;color:var(--muted)">
              No trends yet. Be the first to post with #hashtags!
            </div>
          </div>
          <ul id="trending-list"></ul>
          <button id="resetFeedBtn" class="btn" style="margin-top:10px;width:100%;">
            üîÑ Show All Posts
          </button>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <div class="body">
          <h3>Sentiment & Trends</h3>
          <div class="input-group">
            <label class="input-label">Search Posts</label>
            <input type="text" class="text-input" placeholder="Enter keyword...">
          </div>
          <div class="input-group">
            <label class="input-label">Filter by User</label>
            <input type="text" class="text-input" placeholder="Wallet address...">
          </div>
        </div>
      </div>
    </aside>
  </div>
</main>

<!-- üåÄ Rick Easter Egg -->
<div id="portal"></div>
<img id="rick" src="/img/rick.png" alt="Rick">
<div id="rick-text">Never go into Crypto, Morty!</div>

<!-- JavaScript -->
<script src="/script.js"></script>
</body>
</html>